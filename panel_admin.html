<!DOCTYPE html>
<html lang="es-MX">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel de Administración</title>
  <!-- Bootstrap 5.1 CSS -->
  <link href="bootstrap-5.1.3/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="fontawesome-6.7.2/css/all.css" rel="stylesheet">
  <!-- Estilo -->
  <link rel="stylesheet" href="style/styles.css">
  <link rel="stylesheet" href="style/sweetalert2.min.css">
  <!-- Bootstrap Datepicker CSS -->
   <link rel="stylesheet" href="JQuery/jquery-ui-1.14.1.custom/jquery-ui.css">
</head>
<body class="full-interface">
    <!-- Navbar -->
  <nav class="navbar-custom">
    <div class="logo">
      <a href="index.html" class="text-decoration-none d-flex align-items-center">
          <img src="imagenes/logo dacwhite.png" alt="Logo" />
          <span class="fs-4 fw-bold text-white ms-2">Verificador de Tickets</span>
      </a>
    </div>
    <div class="dropdown">
      <button class="dropdown-toggle navbar-user-btn fw-bold text-white" type="button" id="dropdownUser" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fas fa-user-circle"></i> User
      </button>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownUser">
        <li>
            <a class="dropdown-item text-secondary d-flex align-items-center gap-2" id="rol">
                <i class="fas fa-user-circle"></i> Rol de usuario
            </a>
        </li>
        <div class="divider" style="border-top: 0.1px solid #dee2e6; margin: 10px 0;"></div>
        <li><a class="dropdown-item" id="configuracion">Configuración</a></li>
        <li>
          <a class="dropdown-item" id="historial" data-bs-toggle="modal" data-bs-target="#modalHistorialRevisiones">
            Historial de revisiones
          </a>
        </li>
        <li><a class="dropdown-item" id="paneladmin">Panel de administración</a></li>
        <li>
          <a class="dropdown-item" id="registroempleado" data-bs-toggle="modal" data-bs-target="#modalRegistroEmpleado">
            Registro de empleados
          </a>
        </li>
        <li><a class="dropdown-item" id="cuenta">Cuenta</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item text-danger" id="cerrarses">Cerrar sesión</a></li>
      </ul>
    </div>
  </nav><br>
  <div class="ticket-box ">
     <!-- Botón Regresar -->
        <div class="mb-3">
            <a href="index.html" class="btn btn-warning fw-bold">
                <i class="fas fa-arrow-left me-2"></i> Regresar
            </a>
        </div>
    <h1 class="text-center text-primary fw-bold">Panel de administración</h1>
    <div class="divider" style="border-top: 1px solid #dee2e6; margin: 15px 0;"></div>
    <!-- Alertas pendientes -->
    <h4 class="section-title"><strong>Alertas pendientes</strong></h4>
    <div class="ticket-section p-0">
      <div class="ticket-header d-flex justify-content-between align-items-center">
        <span>Alertas</span>
        <button id="filter-alert" class="btn btn-outline-light btn-sm">Filtrar</button>
      </div>
      <div class="card-body p-2">
        <!-- Alerta 1 -->
        <div class="card mb-3 alerta-ok p-2">
          <small class="text-muted">Ayer, 4:30 PM</small>
          <div class="text-end">
            <button class="btn btn-ver btn-sm mt-2">Ver detalles</button>
          </div>
        </div>
        <!-- Alerta 2 -->
        <div class="card mb-3 alerta-pendiente p-2">
          <div class="d-flex flex-column flex-md-row justify-content-between">
            <div class="mb-2 mb-md-0">
              <span>Ticket duplicado</span> <small class="text-muted">56204732740057</small><br>
              <small class="text-muted">Reportado por: Elian Pérez</small>
              <p class="mb-1 small">El ticket 56204732740057 fue escaneado 2 veces en un intervalo de 5 minutos con diferencias en los productos.</p>
              <small class="text-muted">Hoy, 10:25 AM</small>
            </div>
            <div class="text-md-end">
              <span class="badge btn-pendiente mb-2">Pendiente</span><br>
              <button class="btn btn-resolver btn-sm mb-1 py-1" id="btnResolver">Resolver</button>
              <button class="btn btn-ver btn-sm">Ver detalles</button>
            </div>
          </div>
        </div>
        <!-- Alerta 3 -->
        <div class="card alerta-pendiente p-2">
          <div class="d-flex flex-column flex-md-row justify-content-between">
            <div class="mb-2 mb-md-0">
              <span>Otro</span> <small class="text-muted">559176019353957</small><br>
              <small class="text-muted">Reportado por: Adrian Rentería</small>
              <p class="mb-1 small">Monto incorrecto. El total del ticket 559176019353957 no coincide con la suma de los productos.</p>
            </div>
            <div class="text-md-end">
              <span class="badge btn-pendiente mb-2">Pendiente</span><br>
              <button class="btn btn-ver btn-sm">Ver detalles</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Filtro -->
    <div class="d-flex flex-column flex-md-row gap-2 mt-3">
      <div class="position-relative" style="width: 15%;">
        <input id="datepicker" class="form-control datepicker-input" placeholder="Filtrar por fecha" readonly>
        <i class="fas fa-calendar-alt datepicker-icon"></i>
      </div>
      <button id="BtnUpdate" class="btn btn-primary flex-grow-1">Actualizar datos</button>
    </div>
    <!-- Total de tickets -->
    <div class="mt-3">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h4 class="section-title mb-0"><strong>Total de tickets revisados</strong></h4>
        <div class="btn-group">
          <button id="RevDay" class="btn btn-outline-primary btn-sm">Hoy</button>
          <button id="RevWeek" class="btn btn-outline-primary btn-sm">Semana</button>
          <button id="RevMonth" class="btn btn-outline-primary btn-sm">Mes</button>
          <button id="RevYear" class="btn btn-outline-primary btn-sm">Año</button>
        </div>
      </div>
      <div class="ticket-section p-0">
        <div class="ticket-header d-flex justify-content-between align-items-center">1248 tickets <span class="float-end small">+12% respecto al mes anterior</span></div>
        <div class="card-body p-2  text-center">
          <div class="chart-container">
        <canvas id="ticketsChart"></canvas>
    </div>
        </div>
      </div>
    </div>
    <!-- Anomalías -->
    <div class="mt-3">
      <h4 class="section-title"><strong>Anomalías detectadas</strong></h4>
      <div class="ticket-section p-0">
        <div class="ticket-header d-flex justify-content-between align-items-center">47 anomalías <span class="float-end small">+3.7% del total de tickets</span></div>
        <div class="card-body p-2  text-center">
          <div class="chart-container">
        <canvas id="anomalousTicketsChart"></canvas>
    </div>
        </div>
      </div>
    </div>
    <!-- Exportaciones -->
    <div class="mt-3">
      <h4 class="section-title"><strong>Exportaciones recientes</strong></h4>
      <div class="ticket-section">
        <div class="list-group list-group-flush small">
          <div class="list-group-item p-2">
            <div class="d-flex justify-content-between"><span><strong>Reporte_diario_20250705.xlsx</strong><br><small>Solicitado por: Admin</small></span><small>Hoy, 09:15 AM</small></div>
          </div>
          <div class="list-group-item p-2">
            <div class="d-flex justify-content-between"><span><strong>Anomalias_semana_202507.pdf</strong><br><small>Solicitado por: Supervisor</small></span><small>Ayer, 05:35 PM</small></div>
          </div>
          <div class="list-group-item p-2">
            <div class="d-flex justify-content-between"><span><strong>Resumen_mensual_junio_202506.pdf</strong><br><small>Solicitado por: Admin</small></span><small>3 Jul, 10:23 AM</small></div>
          </div>
          <div class="list-group-item p-2">
            <div class="d-flex justify-content-between"><span><strong>Reporte_diario_20250703 (1).xlsx</strong><br><small>Solicitado por: Admin</small></span><small>3 Jul, 09:43 AM</small></div>
          </div>
          <div class="list-group-item p-2">
            <div class="d-flex justify-content-between"><span><strong>Reporte_diario_20250703.xlsx</strong><br><small>Solicitado por: Admin</small></span><small>3 Jul, 09:42 AM</small></div>
          </div>
        </div>
      </div>
    </div>
    <!-- Seguridad -->
    <div class="mt-3 mb-3">
      <h4 class="section-title"><strong>Controles de seguridad</strong></h4>
      <div class="d-flex gap-2">
        <button id="KickUser" class="btn btn-danger flex-fill">Cerrar todas las sesiones</button>
        <button id="Logs" class="btn btn-secondary flex-fill" data-bs-toggle="modal" data-bs-target="#modalLogSistema">
          Ver el log del sistema
        </button>
      </div>
    </div>
  </div><br>
<!-- Modal Registro de Empleados -->
<div class="modal fade" id="modalRegistroEmpleado" tabindex="-1" aria-labelledby="modalRegistroEmpleadoLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered custom-modal-dialog">
    <div class="modal-content custom-modal-style">
      <div class="modal-header">
        <h5 class="fw-bold w-100 text-center text-primary" id="modalRegistroEmpleadoLabel">
          <i class="fas fa-users"></i> Registro de empleados
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3 text-start">
          <label class="form-label fw-bold">Correo:</label>
          <div class="form-control" contenteditable="true" id="EmplEmail"></div>
        </div>
        <div class="mb-3 text-start">
          <label class="form-label fw-bold">Usuario:</label>
          <div class="form-control" contenteditable="true" id="EmplUser"></div>
        </div>
        <div class="mb-3 text-start">
          <label class="form-label fw-bold">Contraseña:</label>
          <div class="form-control" contenteditable="true" id="EmplPass"></div>
        </div>
        <div class="btn-group-custom d-flex gap-2 flex-wrap mb-3">
          <button type="button" id="add-empl" class="btn btn-success flex-fill">Agregar usuario</button>
          <button type="button" id="edit-empl" class="btn btn-info flex-fill">Editar usuario</button>
          <button type="button" id="delete-empl" class="btn btn-danger flex-fill">Eliminar usuario</button>
        </div>
        <h6 class="usuarios-section text-center">Usuarios</h6>
        <div class="usuarios-list">
          <div class="usuario-item">User1</div>
          <div class="usuario-item">User2</div>
          <div class="usuario-item">User3</div>
          <div class="usuario-item">User...</div>
        </div>
        <div class="info-box text-start mt-3">
          <p class="mb-0">
            <i class="fas fa-info-circle"></i>
            <strong> Recuerda:</strong> Puedes registrar a tus empleados, usando un gafete con un código de barras para colocar su contraseña.
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary w-100">Finalizar</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal Historial de Revisiones -->
<div class="modal fade" id="modalHistorialRevisiones" tabindex="-1" aria-labelledby="historialRevisionesLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered custom-modal-dialog">
    <div class="modal-content custom-modal-style">
      <div class="modal-header">
        <h5 class="fw-bold w-100 text-center text-primary" id="historialRevisionesLabel">
          <i class="fas fa-history"></i> Historial de revisiones</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <!-- Campo Buscar -->
        <div class="mb-3">
          <label class="fw-bold">Buscar por:</label>
          <select class="form-control" id="buscarPor">
            <option>Seleccione el tipo de búsqueda</option>
            <option>Fecha</option>
            <option>Usuario</option>
            <option>Resultado</option>
          </select>
        </div>
        <!-- Valor elegido -->
        <div class="mb-3">
          <label class="fw-bold">[Valor elegido arriba]:</label>
          <div class="form-control" contenteditable="true" id="valorBusqueda"></div>
        </div>
        <!-- Tabla de resultados -->
        <div class="usuarios-section" style="border-radius: 10px 10px 0 0; background-color: #91268F;">
          Resultados de la búsqueda
        </div>
        <div class="usuarios-list">
          <table class="table mb-0">
            <thead>
              <tr style="background-color: #f8f9fa;">
                <th>Fecha y hora de revisión</th>
                <th>Folio de ticket</th>
                <th>Usuario revisor</th>
                <th>Resultado de revisión</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="4" class="text-center text-muted">No hay resultados</td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- Botón Exportar -->
        <button class="btn btn-primary btn-block mt-3" id="btnExportar">EXPORTAR</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal Log del Sistema -->
<div class="modal fade" id="modalLogSistema" tabindex="-1" aria-labelledby="modalLogSistemaLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered custom-modal-dialog modal-lg">
    <div class="modal-content custom-modal-style">
      <div class="modal-header">
        <h5 class="fw-bold w-100 text-center text-primary" id="modalLogSistemaLabel">
          <i class="fas fa-file-alt"></i> Log del sistema
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <div class="usuarios-section" style="border-radius: 10px 10px 0 0; background-color: #91268F; color: white;">
          <strong>Logs</strong>
        </div>
        <div class="usuarios-list small" style="max-height: 400px; overflow-y: auto;">
          <p><strong>Timeout en conexión con POS</strong><br>
            Intentando reconectar... (3er intento). Falló la comunicación con el punto de venta principal.
          <p><strong>No se pudo guardar registro de auditoría</strong><br>
            ConnectionTimeoutException: Se agotó el tiempo de espera para la conexión a la base de datos.
          <p><strong>Ticket procesado</strong><br>
            Ticket #4587 procesado en 1.42s. Productos: 5. Validación exitosa.
          <p><strong>Intento fallido de login</strong><br>
            Usuario: carlos.ruiz desde IP 192.168.1.45. Credenciales incorrectas.
          <p><strong>Reporte diario generado</strong><br>
            Archivo: reporte_diario_20230615.xlsx generado exitosamente y almacenado en /exports/reports
          <p><strong>Sessión iniciada</strong><br>
            Usuario: maria.gomez autenticado correctamente. Navegador: Chrome 114.0.5735.199
          <p><strong>Timeout en conexión con el servidor de base de datos</strong><br>
            Reintentando conexión... (2do intento). Latencia superior a 5000ms en el clúster principal.
          <p><strong>Conexión rechazada por el servicio de autenticación</strong><br>
            El endpoint /api/auth no respondió. Verificando configuración de firewall y certificados TLS.
          <p><strong>Ticket duplicado detectado</strong><br>
            El ticket 37593684632131 fue escaneado 3 veces en un período de 8 minutos con variaciones en los productos.
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary w-100" data-bs-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
  <script src="JQuery/jquery-3.7.1.min.js"></script>
  <script src="bootstrap-5.1.3/js/bootstrap.bundle.min.js"></script>
  <script src="js/panel_admin.js"></script>
  <script src="js/Index.js"></script>
  <script src="JQuery/jquery-ui-1.14.1.custom/jquery-ui.js"></script>
  <script src="js/chart.umd.min.js"></script>
  <script src="js/sweetalert2.min.js"></script>
  </body>
</html>